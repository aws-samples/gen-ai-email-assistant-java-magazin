<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GenMail</title>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" type="text/javascript"></script>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>
    <link rel="stylesheet"
          href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css"/>
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
<section id="sideload-msg" class="ms-welcome__main">
    <h2 class="ms-font-xl">Please <a target="_blank"
                                     href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a>
        your add-in to see app body.</h2>
</section>
<div class="plugin-header-container">
    <div>
        <div class="title"><span style="font-weight: bold">GenMail</span> - dein AI E-Mail Assistent</div>
        <div class="attribution">
            <span>Made with ❤️ by AWS</span>
        </div>
    </div>
</div>
<main id="app-body" class="main-container" style="display: none;">
    <div style="width: 100%">
        <div id="content-container" class="content-container">
            <div id="logged-in-container" style="display: none">                
                <div id="instructions" style="padding-bottom: 30px">
                    <div class="text-input-heading">Instruktionen<span
                            style="color: rgba(128,128,128,0.65); font-size: smaller; padding-left: 5px">(optional)</span></div>
                    <div class="input-group">
                        <textarea class="form-control form-control-sm" id="topics" cols="50" rows="10"></textarea>
                    </div>
                    <div style="font-size: x-small; color: #777676">Hiermit kannst du dem LLM weitere Instruktionen geben und so den Inhalt der Antwort steuern.
                    </div>
                </div>

                <div id="email" class="email-section" style="display: none">
                    <div class="email-container">
                        <div contenteditable="true" class="anon-hide form-control form-control-sm" id="mail-content"></div>
                    </div>
                </div>
            </div>
            <div id="logged-out-container" class="logged-out-container">
                <div class="please-log-in-msg" style="font-weight: bolder">Logge dich ein um das Add-In zu verwenden</div>
            </div>
        </div>

        <div id="controls-container" class="controls">
            <div id="logged-in-buttons" class="logged-in">
                <button style="display: none" type="button" id="generate-reply" class="btn btn-primary btn-sm">Antwort erstellen
                </button>
                <button style="display: none" class="btn btn-primary btn-sm" id="generate-reply-spinner" type="button"
                        disabled>
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Frage LLM, bitte warten.</span>
                </button>

                <button style="display: none" type="button" id="logout" class="btn btn-danger btn-sm logout">
                    Ausloggen
                </button>

            </div>
            <div id="logged-out-buttons" style="padding-top: 10px">
                <button type="button" id="login" class="btn btn-primary btn-sm">Einloggen</button>
            </div>
        </div>
    </div>


    <div id="logs">
        <p style="font-size: x-small"><label id="debug"></label></p>
    </div>
</main>
</body>
</html>
